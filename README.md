# monoidl

Lightweight and plug-able OCaml logger with monoidal message consumers for composability.

[![Build status](https://ci.appveyor.com/api/projects/status/00kimknfcl7m369g/branch/master?svg=true)](https://ci.appveyor.com/project/m-harrison/monoidl/branch/master)

## Usage

The idea behind this library is to give a very functional interface to log OCaml code via, even though the action of logging itself might intrinsically be non-functional. Your code need-not suffer from such icki-ness though!

To use the library you need to start by choosing the `Consumer` implementation you want to use. This is important as it determines how your log messages get handled. `monoidl` provides a selection of these for you to choose from, but if none are suitable then you can implement one of your own (I promised that this was an extendable library!)

```ocaml
...
module ConsoleLogger = Logger(ConsoleConsumer)
...
```

Once you've applied the `Logger` functor to a `Consumer` implementation you are ready to start logging. As this is a _'functional-y'_ library this is done ffrom within a monad, you lift up into the monad via `Logger.return`.

```ocaml
...
let x = y in
ConsoleLogger.return x
...
```

Now your value is wrapped in the monad there are three infix operators that can drive your computation.

```ocaml
val (=>=) : 'a t -> ('a -> 'b) -> 'b t

val (=>|) : 'a t -> ('a -> 'b t) -> 'b t

val (==|) : 'a t -> Message.t -> 'a t
```

If you need to just apply a function to the wrapped value and the function knows nothing about `monoidl` you can use `=>=` to drive the wrapped value along.

```ocaml
...
let f x = x + 1
...
ConsoleLogger.return x
>=> f
...
```



## Acknowledgements

### .gitignore

The `.gitignore` file for this repository was generated by [gitignore.io](https://www.gitignore.io/). To generate the same file go [here](https://www.gitignore.io/api/ocaml).
